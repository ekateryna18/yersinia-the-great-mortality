name: "custom-agent-generation"
title: "G√©n√©rer un Agent Sp√©cialis√©"
description: "Workflow pour cr√©er un nouvel agent BMAD personnalis√© bas√© sur le template"
phase: "custom-agent-creation"

steps:
  - step: 1
    name: "Charger le template"
    action: "context-load"
    context: "agent-template"
    description: "Charger AGENT-TEMPLATE-context.md pour structure de base"

  - step: 2
    name: "Charger le GDD"
    action: "context-load"
    context: "yersinia-gdd"
    description: "R√©f√©rence GDD pour contraintes + m√©caniques"

  - step: 3
    name: "Collecter sp√©cification"
    action: "input-collect"
    fields:
      - field: "agent_name"
        type: "string"
        placeholder: "Ex: Audio Systems Designer"
        required: true
      - field: "agent_specialization"
        type: "string"
        placeholder: "Ex: Design audio, SFX, musique, accessibility"
        required: true
      - field: "agent_persona"
        type: "string"
        placeholder: "Ex: Jean-Pierre Composeur"
        required: true
      - field: "agent_emoji"
        type: "string"
        placeholder: "Ex: üéµ"
        required: true
      - field: "menu_items"
        type: "list"
        placeholder: "Ex: Cr√©er strat√©gie audio, Impl√©menter SFX syst√®me"
        required: true
    description: "Recueillir sp√©cifications pour nouvel agent"

  - step: 4
    name: "G√©n√©rer structure agent"
    action: "agent-generate"
    template: "agent-template"
    inputs:
      - name: "${agent_name}"
      - persona: "${agent_persona}"
      - emoji: "${agent_emoji}"
      - specialization: "${agent_specialization}"
      - menu_items: "${menu_items}"
    description: "Cr√©er fichier agent avec activation steps + menu handlers"

  - step: 5
    name: "Cr√©er workflow d√©di√©"
    action: "workflow-generate"
    for_agent: "${agent_name}"
    description: "G√©n√©rer workflow YAML pour actions de l'agent"

  - step: 6
    name: "Valider structure"
    action: "validation"
    checks:
      - "Agent fichier cr√©√© dans custom/agents/"
      - "YAML frontmatter valide (name, title, description, phase)"
      - "XML activation pr√©sent avec activation steps"
      - "Menu handlers pr√©sents (count = ${menu_items.count})"
      - "Rules section pr√©sent"
      - "Documentation compl√®te"
    description: "V√©rifier structure agent compl√®te"

  - step: 7
    name: "Mettre √† jour manifest"
    action: "manifest-update"
    manifest: "CUSTOM-AGENTS-MANIFEST.md"
    add_agent:
      id: "${agent_name.kebab-case}"
      name: "${agent_name}"
      file: "custom/agents/${agent_name.kebab-case}.md"
      description: "${agent_specialization}"
    description: "Ajouter nouvel agent au manifest de d√©couverte"

  - step: 8
    name: "Tester agent"
    action: "agent-test"
    test_commands:
      - "@agent yersinia-${agent_name.kebab-case}"
      - "Teste: Charge config.yaml"
      - "Teste: Affiche menu items"
    description: "Tester int√©gration agent en Copilot"

outputs:
  - output: "Agent cr√©√©"
    path: "custom/agents/${agent_name.kebab-case}.md"
    format: "markdown"
  - output: "Workflow agent"
    path: "workflows/${agent_name.kebab-case}.yaml"
    format: "yaml"
  - output: "Manifest mis √† jour"
    path: "CUSTOM-AGENTS-MANIFEST.md"
    format: "markdown"

rules:
  - "Agent doit charger config.yaml"
  - "Menu items minimum = 1, maximum = 7"
  - "Persona doit √™tre unique"
  - "Specialization doit √™tre distincte des 9 agents existants"
  - "Chaque agent = nouvel ID kebab-case unique"
  - "Documentation en fran√ßais"
  - "Valider compatibilit√© roguelike"

success_criteria:
  - "Agent fichier cr√©√© avec structure valide"
  - "Agent loadable via @agent yersinia-[id]"
  - "Manifest mis √† jour automatiquement"
  - "Workflow d√©di√© g√©n√©r√© pour actions agent"
  - "Toutes validations pass√©es"
